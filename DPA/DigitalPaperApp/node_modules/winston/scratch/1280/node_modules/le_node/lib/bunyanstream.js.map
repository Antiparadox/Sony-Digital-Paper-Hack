{"version":3,"file":"bunyanstream.js","sources":["../src/bunyanstream.js"],"sourcesContent":["import { Writable } from 'stream';\nimport _ from 'lodash';\nimport * as defaults from './defaults';\nimport Logger from './logger';\n\n/**\n * BunyanStream class.\n */\nclass BunyanStream extends Writable {\n  constructor(opts) {\n    super({\n      objectMode: true\n    });\n\n    const loggerOpts = _.clone(opts || {});\n\n    loggerOpts.timestamp = false;\n    loggerOpts.levels = opts.levels || defaults.bunyanLevels;\n\n    this.logger = new Logger(loggerOpts);\n\n    this.logger.on('error', err => this.emit(err));\n  }\n\n  _write(log, enc, cb) {\n    const lvl = (log.level / 10) - 1;\n\n    this.logger.log(lvl, log);\n\n    setImmediate(cb);\n  }\n\n  get logger() {\n    return this._logger;\n  }\n\n  set logger(obj) {\n    this._logger = obj;\n  }\n}\n\nexport { BunyanStream as default };\n"],"names":["_logger","lvl","level","log","levels","emit","enc","cb","err","logger","on","loggerOpts","opts","defaults","bunyanLevels","timestamp","clone","objectMode","BunyanStream"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;AACA;;IAAYa;;AACZ;;;;;;;;IAKMK;;;AACJ,wBAAYN,IAAZ,EAAkB;AAAA;;AAAA,kJACV;AACJK,kBAAY;AADR,KADU;;AAKhB,QAAMN,aAAa,iBAAEK,KAAF,CAAQJ,QAAQ,EAAhB,CAAnB;;AAEAD,eAAWI,SAAX,GAAuB,KAAvB;AACAJ,eAAWP,MAAX,GAAoBQ,KAAKR,MAAL,IAAeS,SAASC,YAA5C;;AAEA,UAAKL,MAAL,GAAc,qBAAWE,UAAX,CAAd;;AAEA,UAAKF,MAAL,CAAYC,EAAZ,CAAe,OAAf,EAAwB;AAAA,aAAO,MAAKL,IAAL,CAAUG,GAAV,CAAP;AAAA,KAAxB;AAZgB;AAajB;;;;2BAEML;AACnB,UAAMG,MAAOD,IAAIE,KAAJ,GAAY,EAAb,GAAmB,CAA/B;;AAEA,WAAKH,MAAL,CAAYC,GAAZ,CAAgBC,GAAhB,EAAqBD,GAArB;;AAEA,kCAAaF,EAAb;AACD;;;wBAEY;AACX,aAAO,KAAKF,OAAZ;AACD;sBAEUC;AACd,WAAKD,OAAL,GAAeC,GAAf;AACD;;;;;QAGsBF"}