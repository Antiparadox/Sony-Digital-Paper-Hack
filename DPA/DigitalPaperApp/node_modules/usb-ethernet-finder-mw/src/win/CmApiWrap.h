//
//  CmApiWrap.h　
//
//  Windowsに接続されいてる機器情報を取得するために
//  CM_xxx系のAPIをwrapしたクラス。
//
//  Copyright 2016 Sony Corporation
//

#pragma once

#include <windows.h>
#include <cfgmgr32.h>
#include "AutoBinaryPtr.h"
#include "../tstring.h"

class CmApiWrap
{
private:
	CmApiWrap(void){};
	~CmApiWrap(void){};

public:

	static std::string GetDevNodeDriverName(
		/*[in]*/ const DEVINST ulDevInst,
		/*[out]*/ tstring& rsDriverName
		);

	static std::string GetDevNodeDeviceDesc(
		/*[in]*/ const DEVINST ulDevInst,
		/*[out]*/ tstring& rsDeviceDesc
		);

	static std::string GetDevNodeRegistryProperty(
		/*[in]*/ const DEVINST ulDevInst,
		/*[in]*/ const ULONG ulPropertyId,
		/*[out]*/ ULONG& rulRegType,
		/*[out]*/ ULONG& rulDataSize,
		/*[out]*/ AutoBinaryPtr& rspData
		);

	static std::string GetDeviceId(
		/*[in]*/ const DEVINST ulDevInst,
		/*[out]*/ tstring& rsDeviceId
		);
	
	static std::string GetDeviceDescByDriverKeyName(
		/*[in]*/ const tstring& rsDriverKeyName,
		/*[out]*/ tstring& rsDeviceDesc
		);
};
