//
//  KeyUtils.h
//
//  Copyright 2016 Sony Corporation
//

#pragma once

#include <windows.h>
#include <wincrypt.h>
#include <string>


class KeyUtils
{
public:
	static std::string GenRsa2048KeyPair(
		/*[in]*/ const std::string& privateKeyPath,
		/*[in]*/ const std::string& publicKeyPath
		);

private:
	static std::string ExportPrivateKey(
		/*[in]*/ const HCRYPTPROV hProv,
		/*[in]*/ const std::wstring& strKeyPath,
		/*[in]*/ const ULONG ulKeySpec
		);

	static std::string ExportPublicKey(
		/*[in]*/ const HCRYPTPROV hProv,
		/*[in]*/ const std::wstring& strKeyPath,
		/*[in]*/ const ULONG ulKeySpec
		);
};

