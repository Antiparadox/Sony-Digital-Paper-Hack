MilkyWay Registration Data Store (reg-store-mw)
====================

登録情報の保存管理を行うModule

Module Functions
--------------------

* 登録情報の保存管理を行う。
  * 呼び出しに応じて、サーバ証明書をPC/Macにインストールする。
  * 呼び出しに応じて、サーバ証明書をアンインストールする。
  * 登録情報を平文でアプリケーション設定領域に保存する。
  * 保存情報が情報が壊れていることを検出したら、情報が無いものとして扱う。
  * 呼び出しに応じて保存情報を、破棄する。

Module API
--------------------

* [interface](doc/interface.md)


## デバッグ方法

### Windows の場合

Visual Studio を使用して C/C++ のコードをデバッグする際の手順です。

0. 事前に npm install にて依存するmoduleなどをインストールしておく
  ```
  $ cd node-reg-store-mw
  $ npm install
  
  ```
1. node-gyp でビルドを行い、Visual Studio で solution file を開く
  ```
  $ node-gyp build
  $ start ./build/binding.sln
  
  ```
2. "proxy_resolver"プロジェクトのプロパティを開く
3. [構成(C):] を [Release] に変更する
4. [構成プロパティ] > [デバッグ] を開く
5. [コマンド]と[コマンド引数]の値を以下のように設定する
  - コマンド: 
    - node.exe のファイルパス
    - 例）C:\Program Files (x86)\nodejs\node.exe
  - コマンド引数：
    - 実行対象の js ファイルのパス
    - 例）D:\node-reg-store-mw\example\example.js
6. Releaseビルドする
7. デバッグ実行する


### macOS(OS X) の場合

Xcode を使用して C/C++ のコードをデバッグする際の手順です。

0. 事前に npm install にて依存するmoduleなどをインストールしておく
  ```
  $ cd node-reg-store-mw
  $ npm install
  
  ```
1. node-gyp で Xcode の project file を生成し、Xcodeで開く
  ```
  $ cd node-reg-store-mw
  $ node-gyp build
  $ node-gyp configure -- -f xcode
  $ open ./build/binding.xcodeproj/
  
  ```
2. 実行ファイルに node.js を指定する
  1. Xcode のメニューから [Product] > [Scheme] > [Edit Scheme] と選択する
  2. ダイアログ上で [Run] > [Info] を選択し、[Executable] を [Other...] に設定する
  3. [Choose an executable to launch] という実行ファイルの選択ダイアログが表示される
  4. ターミナルで which を実行し、node.js のインストールパスをコピーする
    ```
    $ which node
    /usr/local/bin/node
    
    ```
  5. 実行ファイルの選択ダイアログ上で [Command] + [Shift] + [G] を入力する
  6. [Go to the folder:] に node.js のインストールパスを貼り付け、[Choose]を押す
3. 実行時の引数に js ファイルを指定する
  1. ダイアログ上で [Run] > [Arguments] を選択し、[Arguments Passed On Launch] の [＋] を押す
  2. 実行対象のjsファイルの絶対パス（\"で括る）を入力し、[Close] を押す
4. リンクするライブラリを設定する
  1. Xcode上の左のペインから [binding] を選択する
  2. Xcode上の中央のペインから [Build Phases] を選択する
  3. [Link Binary With Libraries] の [＋] を押し、以下を追加する
    - CoreFoundation.framework
    - Security.framework
5．ビルドして、デバッグ実行する

[補足説明]
- ”npm install” や "node-gyp build"を行うと、Xcode の project file が削除されます
  - ”node-gyp configure -- -f xcode”を実行して、project file を再生成してください