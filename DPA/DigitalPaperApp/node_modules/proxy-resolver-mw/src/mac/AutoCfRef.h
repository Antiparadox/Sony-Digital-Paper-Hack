//
//  AutoCfPtr.h
//
//  Copyright 2016 Sony Corporation
//

#pragma once


template <typename CFRef>
class AutoCfRef
{
private:
    CFRef ptr_;
    
public:
    AutoCfRef(CFRef ptr = nullptr)
        : ptr_(ptr) {
    }
    
    ~AutoCfRef() {
        if (this->ptr_) {
            CFRelease(this->ptr_);
            this->ptr_ = nullptr;
        }
    }
    
    void reset(CFRef ptr = nullptr) {
        if (this->ptr_) {
            CFRelease(this->ptr_);
        }
        this->ptr_ = ptr;
    }	
    
    bool operator==(CFRef ptr) const {
        return (this->ptr_ == ptr);
    }
    
    bool operator!=(CFRef ptr) const {
        return (this->ptr_ != ptr);
    }
    
    operator CFRef() const {
        return ptr_;
    }
    
    const CFRef get() const
    {
        return this->ptr_;
    }
    
    operator bool() const {
        return !!this->ptr_;
    }
    
    bool operator!() const {
        return !this->ptr_;
    }
    

};

