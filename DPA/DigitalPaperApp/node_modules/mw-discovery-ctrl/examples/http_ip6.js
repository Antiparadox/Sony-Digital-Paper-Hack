'use strict';

var http = require('http');
var url = require('url');


function ping(address) {
  var url_options;
  if (address.indexOf(':') === -1) {
    //IPv4
    url_options = {
      family: 4,
      hostname: address,
      port: 8080,
      method: 'GET',
      path: '/register/serial_number'
    };
  }
  else {
    //IPv6
    url_options = {
      family: 6,
      hostname: address,
      port: 8080,
      method: 'GET',
      path: '/register/serial_number',
    };
  }
console.log('%%%', url_options);
  var req = http.request(url_options, function(response) {
    var body = '';
    response.on('data', function(chunk) {
      body += chunk;
    });
    response.on('end', function() {
        console.log('###done');
        console.log(body);
      if (body.length > 0) {
        var r = JSON.parse(body);
        //callback(address, r.value);
      }
    });
  });
  req.on('error', function(e) {
      console.log('###', e);
    //callback(address, null);
  });
    req.end();
}


ping('fe80::76c6:3bff:fe16:31d3%4');
ping('192.168.0.211');
